---
- name: ðŸ§¹ Stop old backend container if running
  command: docker stop provertos_backend
  ignore_errors: yes

- name: ðŸ”„ Remove old backend container
  command: docker rm provertos_backend
  ignore_errors: yes

- name: ðŸ§± Build backend Docker image
  command: docker build -t provertos_backend:latest ./backend
  args:
    chdir: "{{ project_root }}"

- name: ðŸš€ Run backend container
  command: >
    docker run -d --name provertos_backend
    -p 5000:5000
    -e MONGO_URL={{ lookup('env', 'MONGO_URL') }}
    provertos_backend:latest
